# 2023-2024 赛季名额分配方案

修订：[@ligen131](https://github.com/ligen131) [@gongchen618](https://github.com/gongchen618) [@Weierstrass](https://codeforces.com/profile/Weierstrass) [@only_xiaohuang](https://codeforces.com/profile/only_xiaohuang) [@walk_alone](https://codeforces.com/profile/walk_alone) [@yzyyylx](https://codeforces.com/profile/yzyyylx) [@Smokey_Days](https://codeforces.com/profile/Smokey_Days)

| 日期      | 版本      |
| --------- | --------- |
| 2023.5.30 | v1.0 发布 |

## 1 总则

1. 本方案为 HUST ACM-ICPC 集训队区域赛、邀请赛与 ICPC EC Final、CCPC Final 的名额分配方案。
2. 本方案由上一赛季队长交接后，下一赛季队长（下称本届队长）执行修订。本届队长可在上一赛季区域赛、邀请赛与 ICPC EC Final、CCPC Final 全部打完之后，下一赛季**本校多校截止报名之前**修改该方案。方案修改后应进行为期 3 天的公示。若在草案公示期内存在异议，本届队长应进行及时修改补充并重新公示。
3. 本方案自草案公示期截止后，持续到本赛季结束**始终生效且不得修改**。**在生效期间的未尽事宜，本届队长拥有最终解释与裁定权。**

## 2 约定

1. 赛季：一般以年为单位，持续时间自 7 月中旬到次年 5 月下旬，包括多校、ICPC / CCPC 网络赛、ICPC / CCPC 区域赛、CCPC 女生赛、ICPC EC Final、CCPC Final、ICPC / CCPC 全国邀请赛等。
2. 队伍年级：由该队伍组成成员年级中位数决定。若队伍由 2021、2021、2022 级成员组成，则该队伍为 2021 级队伍；若队伍由 2021、2022、2022 级成员组成，则该队伍为 2022 级队伍。 新生队伍：指在本赛季队伍年级为大一的队伍，对于降转学生应认定为下一级学生（即，若该生于 2021 年入学，2022 年降转为大一学生，则在此处该生为 2022 级学生）。 老生队伍：除新生队伍以外的队伍。 例如，在 2022-2023 赛季中，由 2021、2021、2022 级成员组成的队伍为老生队伍，由 2021、2022、2022 级成员组成的队伍为新生队伍。
3. 突出贡献队伍：指获得 World Finals 资格的队伍，或在 ICPC EC Final 或 CCPC Final 中获得金牌的队伍。

## 3 ICPC / CCPC 区域赛名额分配规则

在本校多校报名截止时，根据个人 [CodeForces](https://codeforces.com) 或 [AtCoder](https://atcoder.jp/) Max Rating，符合以下条件其一人员即可参与本校多校报名与赛站名额分配：

1. 个人 [CodeForces](https://codeforces.com) 一年内 Max Rating > 1750，超过一年需要按 200/年 逐年递增。例如，在一年前~两年内期间的 Max Rating 需 > 1950，在两年前~三年内期间的 Max Rating 需 > 2150，以此类推。
2. 个人 [AtCoder](https://atcoder.jp/) 一年内 Max Rating > 1600，超过一年需要按 200/年 逐年递增。

依据本规则，本校参与本赛季比赛的队伍将按照一定的顺序获得多个赛站的选择权。在多校结束后，将公布初步的赛站选择顺序。待网络赛结束，并确定 ICPC / CCPC 各个区域赛的时间和名额数量后，将公布本赛季最终的赛站选择顺序。由于此期间允许队伍成员更换，初步和最终的赛站选择顺序可能不完全一致。

本规则将 ICPC / CCPC 区域赛名额分为 A、B 两类名额。首先，由 A 类名额财务与队长队伍进行赛站选择；其次，根据 B 类名额积分排行，各队伍将获得赛站选择的顺序，并依次对 ICPC / CCPC 区域赛赛站进行预选。队伍进行赛站选择时，只能选择一个未被选定的赛站或放弃选择，直到所有区域赛赛站都被选定为止。若该队伍已选满上限，则自动跳过该队伍。

例如，队伍 1 获得了 ICPC 的顺次 1 和顺次 3，以及 CCPC 的顺次 2；队伍 2 获得了 ICPC 的顺次 2，以及 CCPC 的顺次 1 和顺次 3。在本赛季中，ICPC 名额为 3 个，CCPC 名额为 2 个。因此，它们的选择顺序如下：对于 ICPC，依次为队伍 1 → 队伍 2 → 队伍 1；对于 CCPC，依次为队伍 2 → 队伍 1。

**请注意，原则上自网络赛开始后到本赛季结束，不允许更换队伍成员。**因特殊情况需更换队伍成员者，请**自行承担拆队对个人比赛名额造成的影响**。若在多校结束后到网络赛开始的时间段内出现队伍成员变动，将按照新队伍积分＝成员个人积分之和的方式更新队伍积分及排名。

根据官方规定，在同一赛季中，每个参赛成员最多可参与 2 个 ICPC 和 2 个 CCPC 区域赛赛站（包括 CCPC 女生赛或区域赛女队名额参赛）的正式比赛（非正式参赛[即打星]不受此限制）。

附：ICPC 历年名额分配规则：<https://icpc.pku.edu.cn/>

附：CCPC 历年名额分配规则：<https://ccpc.io/>

### 3.1 A 类名额 - 直接分配

A 类名额共 4 个，其中 ICPC 名额**至少** 2 个，至多 4 个，CCPC 名额**至多** 2 个。在 A 类名额选择时，应先选择需要 ICPC / CCPC 名额，再选择赛站；若在前一顺位已选满 2 个 CCPC 名额，则后面顺位不得再选择 CCPC 赛站。

### 3.1.1 财务名额

本赛季财务所在队伍可获得 1 个 A 类名额，优先于其他所有名额对赛站进行选择。财务所在队伍正常参与 B 类名额分配，直到该队选满上限为止。

### 3.1.2 队长名额

本赛季队长所在队伍可获得 1 个 A 类名额，于财务之后并优先于财务之外的所有名额选择赛站。队长所在队伍正常参与 B 类名额分配，直到该队选满上限为止。

### 3.1.3 新生队伍预留名额

剩余 2 个 A 类名额分配给本赛季新生队伍，并在队长和财务进行选择后，预先在数量上扣除并保留至新生赛。

新生队伍的名额预留规则为，若财务与队长选择完毕时， CCPC 名额尚有剩余，则以 1 ICPC + 1 CCPC 名额占用该部分 A 类名额，否则以 2 ICPC 名额占用该部分 A 类名额。

新生队伍可且仅可获得新生队伍预留名额，不参与 B 类名额分配。

新生赛结束后，应在新生赛排名名单中除去非新生后依据新生个人排名确定预留名额去向。确定方法如下：新生赛排名第 1 的新生可以选择是否在已预留并剩余的赛站名额中拿取 1 个名额，并组建任意合法队伍进行参赛。若选择拿取名额，应在名单中除去此队的新生成员后，继续由剩余名单中排名第 1 的新生按如上方法选择第二个预留名额。若选择放弃名额，应在名单中除去该新生后重新确定。

### 3.2 B 类名额 - 积分分配

除去 A 类名额的其他名额，采取积分制对赛站选择顺序进行排序。**ICPC / CCPC 积分分别独立计算**（下文统称积分）。所有积分保留小数点后 6 位且所有计算向下取整。

积分分配到个人，在多校确定本赛季队伍后，将以下两部分加入队伍排行榜进行赛站选择顺序排序（积分大者优）：

1. 队伍所有成员积分之和（下称队伍积分）。
2. 设 m = 除去 A 类名额后剩余名额数量，n = 本校参与分配名额的有效队伍数量，$\Phi^{-1}$ 为标准正态分布函数的反函数，令
   
   <span class="arithmatex">\\\[\beta=\min\left\lbrace\Phi^{-1}\left(\frac{2m}{3 n}\right)-\Phi^{-1}\left(\frac{m}{3n}\right), 1\right\rbrace\\\]</span>
   
   则参与排序的积分 = 队伍积分 - (本校所有有效参赛队伍积分标准差 * $\beta$ )。

该排行榜保证了每只队伍都有 2 次可能的选择机会。

例如，有如下队伍与积分（剩余未列出），假设所有队伍积分的标准差为 1.658313，m 取 12，n 取 22：

| 队伍  | 积分        |
| ----- | ----------- |
| Team1 | 7           |
| Team2 | 5.558124109 |
| Team3 | 5.098155111 |
| Team4 | 4.528582421 |
| Team5 | 4.414525467 |

则队伍排行榜为：

| 顺位 | 队伍  | 积分        |
| ---- | ----- | ----------- |
| 1    | Team1 | 7.000000    |
| 2    | Team1 | 6.071838132 |
| 3    | Team2 | 5.558124    |
| 4    | Team3 | 5.098155    |
| 5    | Team2 | 4.629962241 |
| 6    | Team4 | 4.528582    |
| 7    | Team5 | 4.414525    |
| 8    | Team3 | 4.169993243 |
| 9    | Team4 | 3.600420554 |
| 10   | Team5 | 3.4863636   |

根据排行榜顺位，队伍依次进行赛站选择。

#### 3.2.1 多校与网络赛积分

参考[牛客 22-23 赛季官方积分公式](https://docs.qq.com/sheet/DTHJyQkl3UE5ETU1Y)，每一场牛客 / 杭电多校 / 网络赛根据如下公式计算得分：

单场**得分** = (解题数 / 本校最高解题数) * (2 * 本场参赛队伍数 - 2) / (本场参赛队伍数 + 名次 - 2)

ICPC **得分** = 牛客多校最高得分前 6 场之和 + 第一场网络赛得分

CCPC **得分** = 杭电多校最高得分前 7 场之和 + 第二场网络赛得分

根据得分计算积分，同一队伍内队员的个人积分相同。

ICPC 个人积分 = (ICPC 得分 / 本校 ICPC 最高得分) * 7

CCPC 个人积分 = (CCPC 得分 / 本校 CCPC 最高得分) * 7

#### 3.2.2 过往赛季积分

过往赛季积分在多校与网络赛积分的基础上附加于个人积分上。对于涉及计算积分的赛季，同一队伍内队员的附加个人积分相同。

过往赛季仅追溯最多 2 个赛季，上一赛季需要在下文所列数值的基础上乘以 1/2 再算入个人积分，上上赛季需要在下文所列数值的基础上乘以 1/4 再算入个人积分。

当赛季有完整参与的正式比赛方可计入该部分积分。

1. 当赛季在 ICPC / CCPC 区域赛获得金 / 银 / 铜 / 无 奖的，分别在 ICPC / CCPC 个人积分加上 2 / 1 / 0 / -0.5 分。
2. 当赛季在 ICPC EC Final / CCPC Final 获得金 / 银 / 铜 / 无 奖的，分别在 ICPC / CCPC 个人积分加上 4 / 2 / 1 / 0 分。

此外，**对于从未参加过过往赛季 ICPC / CCPC 正式比赛的，分别在其个人 ICPC** **/ CCPC 积分上加上 0.4 分。**

例如，某一队员在上一赛季中获得 ICPC 区域赛 1 金 1 银，ICPC EC Final 1 银，上上赛季中获得 ICPC 区域赛 2 银的成绩，则在该队员的个人 ICPC 积分上加上 1/2 * (2 + 1 + 2) + 1/4 * (1 + 1) = 3 分。若该队员从未参加过 CCPC 正式比赛，则在该队员的个人 CCPC 积分上加上 0.4 分。

### 3.3 女生队伍名额 / CCPC 女生赛

CCPC 每年会举行 CCPC 女生区域赛，仅接受女生队伍报名，女生队伍需要参赛队员均为女生。此外，ICPC / CCPC 部分赛站会有少量女生队伍名额。

CCPC 女生赛和区域赛女队均视为正常区域赛参赛，即队伍成员也均应符合当赛季最多参与 2 场 ICPC 和 2 场 CCPC 区域赛赛站的正式比赛的官方约束。

CCPC 女生赛不限制各校报名队伍数量，应报尽报。区域赛女队名额由于数量较少，由队长直接进行分配。

在 CCPC 女生赛中排名前五的队伍可以直接获得 1 个 CCPC Final 名额而不占据学校名额。

### 3.4 非正式参赛[打星]名额

ICPC / CCPC 区域赛部分赛站允许少量队伍非正式参赛[打星]，打星名额分配遵从以下原则：

确定允许打星的赛站以及名额数量后，由队长组织定时开抢，遵循**先到先得**的原则。具体时间和开抢方式应提前至少 3 天公布。

## 4 ICPC EC Final / CCPC Final 名额分配规则

本赛季 ICPC + CCPC 区域赛正式参赛场数大于等于 2 场队伍，且没有出现拆队情况，即可参与 Final 名额分配。根据本赛季已完成的 ICPC 和 CCPC 区域赛（注：若本赛季香港 / 澳门赛站不在 ICPC EC Final 官方统计名额之内，则不在本规则中计数）计算单场 Final 积分：

单场 Final 积分 = ((该场区域赛排名 / MIN(350, 该场区域赛有效的正式参赛队伍数)) * 350)

设 N = 该队伍本赛季正式参与过的所有 ICPC 和 CCPC 区域赛场数，S = 该队伍本赛季正式参与过的所有 **ICPC 和 CCPC 区域赛单场 Final 积分**之**积**，计算总 Final 积分：

总 Final 积分 = $\sqrt[N]{S}$

对于以下两类队伍（队伍拆队无效），**直接分配 1 ICPC EC Final + 1 CCPC Final 名额：**

1. 上赛季的**突出贡献队伍**与本赛季获得 World Finals 资格的队伍。
2. 本赛季分配区域赛 B 类名额时 ICPC 队伍积分与 CCPC **队伍积分**之**和**超过 54 分者（见 3.2 节）。

对于剩余名额合并考虑，**仅老生队伍参与剩余名额的分配**，根据队伍 Final 积分正序排名（积分小者优）顺序依次选择 Final 场次，直到所有名额被选完为止。

值得注意的是，每年 ICPC 官方会公布 EC Final 入选队伍名单，按照该方案选择赛站的名单可能会与官方名单有所差别。有以下情况需要特殊考虑：

1. 若本赛季 ICPC 官方不允许更换 EC Final 官方名单队伍，则该部分规则对 ICPC EC Final 无效，在排除已经在 ICPC EC Final 官方名单中的队伍后，再依照剩余队伍 Final 积分正序排名给予 CCPC Final 名额。
2. 所有参与 ICPC EC Final 的队伍需满足 ICPC 官方给出的条件（例如至少获得一枚区域赛银牌），若不满足条件则只能选择 CCPC Final 名额。
3. 若出现未参与 CCPC 而获得本校 CCPC Final 名额的队伍，依据本赛季 CCPC Final 文件视情况决定是否能够让该队伍参与 CCPC Final，若不能则自动顺延至排名靠后的队伍。
4. 未尽事宜，由队长参考本规则合理安排名额分配。

此外，在 CCPC 女生赛中排名前五的队伍可以直接获得 1 个 CCPC Final 名额而不占据学校名额。

## 5 ICPC / CCPC 邀请赛名额分配规则

于所有邀请赛名额数量确定后，将所有邀请赛名额合并分配。分配遵从以下原则：

1. 以邀请赛总名额 75% 向下取整作为新生队伍上限，剩余名额作为老生队伍上限。
2. 确定新生 / 老生队伍的数量上限后，由队长组织定时开抢赛站，并在不超过新生 / 老生队伍数量上限的前提下遵循**先到先得**的原则。具体时间和开抢方式应提前至少 3 天公布。
3. 若在第一轮抢赛站队伍数量上限未达标，应在抢赛站结束后进行统一公布，并再次约定第二轮抢赛站时间 / 方式。第二轮抢赛站机会将对全体队伍无条件开放。

## 6 未提及比赛名额分配规则

遵从以下原则：

1. 若有涉及到 ICPC / CCPC 正式比赛名额数量增减的重要赛事，由队长指定派出本校最强队伍出战。
2. 本规则已对主要赛事的名额分配规则均进行了说明。对于本规则未说明的比赛，由队长参考本规则合理安排名额分配。